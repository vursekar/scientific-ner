On Negative Interference in Multilingual Models : Findings and A Meta - Learning Treatment
Zirui Wang
Zachary C. Lipton
Yulia Tsvetkov
Carnegie Mellon University , Pittsburgh , USA { ziruiw , zlipton , ytsvetko}@cs.cmu.edu
Abstract
Modern multilingual models are trained on concatenated text from multiple languages in hopes of conferring beneﬁts to each ( positive transfer ) , with the most pronounced beneﬁts accruing to low - resource languages .
However , recent work has shown that this approach can degrade performance on high - resource languages , a phenomenon known as negative interference .
In this paper , we present the ﬁrst systematic study of negative interference .
We show that , contrary to previous belief , negative interference also impacts low - resource languages .
While parameters are maximally shared to learn language - universal structures , we demonstrate that language - speciﬁc parameters do exist in multilingual models and they are a potential cause of negative interference .
Motivated by these observations , we also present a meta - learning algorithm that obtains better cross - lingual transferability and alleviates negative interference , by adding languagespeciﬁc layers as meta - parameters and training them in a manner that explicitly improves shared layers ’ generalization on all languages .
Overall , our results show that negative interference is more common than previously known , suggesting new directions for improving multilingual representations.1
1
Introduction
Advances in pretraining language models ( Devlin et al , 2018 ; Liu et al , 2019 ; Yang et al , 2019 ) as general - purpose representations have pushed the state of the art on a variety of natural language tasks .
However , not all languages enjoy large public datasets for pretraining and/or downstream tasks .
Multilingual language models such as mBERT ( Devlin et al , 2018 ) and XLM ( Lample and Conneau , 2019 ) have been proven effective for cross - lingual
1Source code is available at https://github.com/
iedwardwangi / MetaAdapter .
transfer learning by pretraining a single shared Transformer model ( Vaswani et al , 2017 ) jointly on multiple languages .
The goals of multilingual modeling are not limited to improving language modeling in low - resource languages ( Lample and Conneau , 2019 ) , but also include zero - shot crosslingual transfer on downstream tasks — it has been shown that multilingual models can generalize to target languages even when labeled training data is only available in the source language ( typically English ) on a wide range of tasks ( Pires et al , 2019 ; Wu and Dredze , 2019 ; Hu et al , 2020 ) .
However , multilingual models are not equally beneﬁcial for all languages .
Conneau et al ( 2019 ) demonstrated that including more languages in a single model can improve performance for lowresource languages but hurt performance for highresource languages .
Similarly , recent work ( Johnson et al , 2017 ; Tan et al , 2019 ; Aharoni et al , 2019 ; Arivazhagan et al , 2019 ) in multilingual neural machine translation ( NMT ) also observed performance degradation on high - resource language pairs .
In multi - task learning ( Ruder , 2017 ) , this phenomenon is known as negative interference or negative transfer ( Wang et al , 2019 ) , where training multiple tasks jointly hinders the performance on individual tasks .
Despite these empirical observations , little prior work analyzed or showed how to mitigate negative interference in multilingual language models .
Particularly , it is natural to ask : ( 1 ) Can negative interference occur for low - resource languages also ?
( 2 ) What factors play an important role in causing it ?
( 3 ) Can we mitigate negative interference to improve the model ’s cross - lingual transferability ?
In this paper , we take a step towards addressing these questions .
We pretrain a set of monolingual and bilingual models and evaluate them on a range of downstream tasks to analyze negative interference .
We seek to individually characterize the unProceedingsofthe2020ConferenceonEmpiricalMethodsinNaturalLanguageProcessing , pages4438–4450,November16–20,2020.c(cid:13)2020AssociationforComputationalLinguistics4438  derlying factors of negative interference through a set of ablation studies and glean insights on its causes .
Speciﬁcally , we examine if training corpus size and language similarity affect negative interference , and also measure gradient and parameter similarities between languages .
Our results show that negative interference can occur in both high - resource and low - resource languages .
In particular , we observe that neither subsampling the training corpus nor adding typologically similar languages substantially impacts negative interference .
On the other hand , we show that gradient conﬂicts and language - speciﬁc parameters do exist in multilingual models , suggesting that languages are ﬁghting for model capacity , which potentially causes negative interference .
We further test whether explicitly assigning language - speciﬁc modules to each language can alleviate negative interference , and ﬁnd that the resulting model performs better within each individual language but worse on zero - shot cross - lingual tasks .
Motivated by these observations , we further propose to meta - learn these language - speciﬁc parameters to explicitly improve generalization of shared parameters on all languages .
Empirically , our method improves not only within - language performance on monolingual tasks but also cross - lingual transferability on zero - shot transfer benchmarks .
To the best of our knowledge , this is the ﬁrst work to systematically study and remedy negative interference in multilingual language models .
2 Motivation
Multilingual transfer learning aims at utilizing knowledge transfer across languages to boost performance on low - resource languages .
State - of - theart multilingual language models are trained on multiple languages jointly to enable cross - lingual transfer through parameter sharing .
However , languages are heterogeneous , with different vocabularies , morphosyntactic rules , and different pragmatics across cultures .
It is therefore natural to ask , is knowledge transfer beneﬁcial for all languages in a multilingual model ?
To analyze the effect of knowledge transfer from other languages on a speciﬁc language lg , we can compare multilingual models with the monolingual model trained on lg .
For example , in Figure 1 , we compare the performance on a named entity recognition ( NER ) task of monolingually - trained models vs. bilingual models ( trained on lg and English ) vs. state - ofFigure 1 : Comparing monolingual vs multilingual models on NER .
Lower performance of multilingual models is likely an indicator of negative interference .
the - art XLM ( Conneau et al , 2019 ) .
We can see that monolingual models outperform multilingual models on four out of six languages ( See § 3.3 for details ) .
This shows that language conﬂicts may induce negative impacts on certain languages , which we refer to as negative interference .
Here , we investigate the causes of negative interference ( § 3.3 ) and methods to overcome it ( § 4 ) .
3
Investigating the Sources of Negative Interference in Multilingual Models
3.1 Methodology
To study negative interference , we compare multilingual models with monolingual baselines .
Without loss of generality , we focus on analyzing bilingual models to minimize confounding factors .
For two languages lg1 and lg2 , we pretrain a single bilingual model and two monolingual models .
We then assess their performance on downstream tasks using two different settings .
To examine negative interference , we evaluate both monolingual and multilingual models using the withinlanguage monolingual setting , such that the pretrained model is ﬁnetuned and tested on the same language .
For instance , if the monolingual model of lg1 outperforms the bilingual model on lg1 , we know that lg2 induces negative impact on lg1 in the bilingual model .
Besides , since multilingual models are trained to enable cross - lingual transfer , we also report their performance on the zero - shot cross - lingual transfer setting , where the model is only ﬁnetuned on the source language , say lg1 , and tested on the target language lg2 .
We hypothesize that the following factors play important roles in causing negative interference and study each individually :
Training Corpus Size While prior work mostly report negative interference for high - resource lan4439  corpus size NER POS QA XNLI
en
44.6 ( cid:88 ) ( cid:88 ) ( cid:88 ) ( cid:88 )
ar
8.7 ( cid:88 ) ( cid:88 ) ( cid:88 ) ( cid:88 )
fr
ru
hi
sw te
16.2 ( cid:88 ) ( cid:88 )
( cid:88 )
13.1 ( cid:88 ) ( cid:88 ) ( cid:88 ) ( cid:88 )
0.3 0.2 0.5 ( cid:88 ) ( cid:88 ) ( cid:88 ) ( cid:88 ) ( cid:88 ) ( cid:88 ) ( cid:88 )
( cid:88 ) ( cid:88 )
Table 1 : Language training corpra statitstics and downstream tasks availability .
Corpus size measured in millions of sentences .
guages ( Conneau et al , 2019 ; Arivazhagan et al , 2019 ) , we hypothesize that it can also occur for languages with less resources .
We study the impact of training data size per language on negative interference .
We subsample a high - resource language , say lg1 , to create a “ low - resource version ” .
We then retrain the monolingual and bilingual models and compare with results of their high - source counterparts .
Particularly , we test if reducing lg1 ’s training size also reduces negative interference on lg2 .
Language Similarity Language similarity has been shown important for effective transfer in multilingual models .
Wu et al ( 2019 ) shows that bilingual models trained on more similar language pairs result in better zero - shot transfer performance .
We thus expect it to play a critical role in negative interference as well .
For a speciﬁc language lg1 , we pair it with languages that are closely and distantly related .
We then compare these bilingual models ’ performance on lg1 to investigate if more similar languages cause less severe interference .
In addition , we further add a third language lg3 that is similar to lg1 and train a trilingual model on lg1 - lg2 - lg3 .
We compare the trilingual model with the bilingual model to examine if adding lg3 can mitigate negative interference on lg1 .
Gradient Conﬂict Recent work ( Yu et al , 2020 ) shows that gradient conﬂict between dissimilar tasks , deﬁned as a negative cosine similarity between gradients , is predictive of negative interference in multi - task learning .
Therefore , we study whether gradient conﬂicts exist between languages in multilingual models .
In particular , we sample one batch for each language in the model and compute the corresponding gradients ’ cosine similarity for every 10 steps during pretraining .
Parameter Sharing State - of - the - art multilingual models aim to share as many parameters as possible in the hope of learning a languageuniversal model for all languages ( Wu et al , 2019 ) .
While prior studies measure the latent embedding
similarity between languages , we instead examine model parameters directly .
The idea is to test whether model parameters are language - universal or language - speciﬁc .
To achieve this , we prune multilingual models for each language using relaxed L0 norm regularization ( Louizos et al , 2017 ) , and compare parameter similarities between languages .
Formally , for a model f ( · ; θ ) parameterized by θ = { θi}n i=1 where each θi represents an individual parameter or a group of parameters , the method introduces a set of binary masks z , drawn from some distribution q(z|π ) parametrized by π , and learns a sparse model f ( · ; θ(cid:12)z ) by optimizing :
( cid:34 )
1 N
N ( cid:88 )
i=1
min π
Eq(z|π )
s.t .
˜θ = θ ( cid:12 ) z ,
L(f ( xi ; ˜θ ) , yi ) + λ(cid:107 ) ˜θ(cid:107)0
( cid:35 )
( 1 ) where ( cid:12 ) is the Hadamard ( elementwise ) product , L ( · ) is some task loss and λ is a hyper - parameter .
We follow the work of ( Louizos et al , 2017 ) and use the Hard Concrete distribution for the binary mask z , such that the above objective is fully differentiable .
Then , for each bilingual model , we freeze its pretrained parameter weights and learn binary masks z for each language independently .
As a result , we obtain two independent sets of mask parameters π which can be used to determine parameter importance .
Intuitively , for each parameter group , it is language - universal if both languages consider it important ( positive π values ) .
On the other hand , if one language assigns positive value while the other assigns negative , it shows that the parameter group is language - speciﬁc .
We compare them across languages and layers to analyze parameter similarity in multilingual models .
3.2 Experimental Setup
We focus on standard multilingual masked language modeling ( MLM ) used in mBERT and XLM .
We ﬁrst pretrain models and then evaluate their performance on four NLP benchmarks .
For pretraining , we mainly follow the setup and implementation of XLM ( Lample and Conneau , 2019 ) .
We focus on monolingual and bilingual models for a more controllable comparison , which we refer to as Mono and JointPair respectively .
In particular , we always include English ( En ) in bilingual models to compare on zero - shot transfer settings with prior work .
Besides , we consider three
4440  ar
fr
ru
sw
te
avg
ar
fr
te
avg
Within - language Monolingual
Model
Mono JointPair + ffn + attn + adpt + share adpt + meta adpt
XLM
JointPair + ffn + attn + adpt + share adpt + meta adpt
XLM
89.2 86.9 88.2 87.3 87.8 86.8 88.9
89.4
38.1 8.9 15.4 37.2 38.5 44.4
44.8
88.0 86.5 88.4 86.8 86.8 86.7 88.3
87.5
77.5 35.2 39.4 75.5 77.8 78.5
78.3
NER ( F1 ) hi
87.8 84.2 86.6 84.1 84.5 84.3 85.1
85.5
57.5 5.8 10.2 59.2 58.4 62.4
63.6
89.1 88.3 88.9 88.5 87.7 88.6 88.4
88.5
61.4 10.5 9.9 61.0 62.0 66.0
65.8
85.1 86.1 85.4 84.9 86.3 86.1 86.5
86.3
64.8 9.7 13.4 64.4 65.4 67.3
68.4
Zero - shot Cross
- lingual
82.1 76.2 81.2 77.4 77.0 76.0 79.5
80.5
45.2 12.5 11.6 44.7 44.5 50.1
49.3
86.9 84.7 86.5 84.8 85.0 84.8 86.1
86.3
57.4 13.8 16.7 57.0 57.8 61.5
61.7
92.7 89.2 92.4 91.8 91.7 89.3 92.4
94.5
58.5 5.4 6.2 57.0 58.7 63.5
62.8
76.2 75.8 76.1 75.4 75.6 76.4 75.9
72.9
44.2 8.1 4.5 43.5 43.8 44.6
42.4
POS ( F1 ) hi ru
96.7 93.2 95.6 94.4 94.0 93.5 95.1
96.6
80.1 4.5 7.5 81.6 82.5 84.9
86.3
97.0 95.2 96.1 95.3 95.2 95.2 95.8
97.1
58.9 3.3 4.8 58.2 59.7 62.7
65.7
94.5 88.7 92.4 90.9 91.5 88.2 92.2
92.2
72.8 7.7 6.9 73.5 71.8 78.5
76.9
91.4 88.4 90.5 89.6 89.6 88.5 90.3
90.7
62.9 5.8 6.0 62.8 63.3 66.8
66.8
Table 2 : NER and POS results .
We observe negative interference when monolingual models outperform multilingual models .
Besides , adding language - speciﬁc layers ( e.g. ffn ) mitigates interference but sacriﬁces transferability .
1
)
j Lj
high - resource languages { Arabic ( Ar ) , French ( Fr ) , Russian ( Ru ) } and three low - resource languages { Hindi ( Hi ) , Swahili ( Sw ) , Telugu ( Te ) } ( see Table 1 for their statistics ) .
We choose these six languages based their data availability in downstream tasks .
We use Wikipedia as training data with statistics shown in Table 1 .
For each model , we use BPE ( Sennrich et al , 2016 ) to learn 32k subword vocabulary shared between languages .
For multilingual models , we sample language proportionally to Pi = ( Li(cid:80 ) T , where Li is the size of the training corpus for i - th language pair and T is the temperature .
Each model is a standard Transformer ( Vaswani et al , 2017 ) with 8 layers , 12 heads , 512 embedding size and 2048 hidden dimension for the feedforward layer .
Notice that we speciﬁcally consider a smaller model capacity to be comparable with existing models with larger capacity but also include much more ( over 100 ) languages .
We use the Adam optimizer ( Kingma and Ba , 2014 ) and exploit the same learning rate schedule as Lample and Conneau ( 2019 ) .
We train each model with 4 NVIDIA V100 GPUs with 32 GB of memory .
Using mixed precision , we ﬁt a batch of 128 for each GPU and the total batch size is 512 .
Each epoch contains 10k steps and we train for 50 epochs .
For evaluation , we consider four downstream tasks : named entity recognition ( NER ) , part - ofspeech tagging ( POS ) , question answering ( QA ) , and natural language inference ( NLI ) .
( See Appendix A for ﬁnetuning details . )
NER We use the WikiAnn ( Pan et al , 2017 ) dataset , which is a sequence labelling task built automatically from Wikipedia .
A linear layer with softmax classiﬁer is added on top of pretrained models to predict the label for each word based on its ﬁrst subword .
We report the F1 score .
POS Similar to NER , POS is also a sequence labelling task but with a focus on synthetic knowledge .
In particular , we use the Universal Dependencies treebanks ( Nivre et al , 2018 ) .
Task - speciﬁc layers are the same and we report F1 , as in NER .
QA We choose to use the TyDiQA - GoldP dataset ( Clark et al , 2020 ) that covers typologically diverse languages .
Similar to popular QA dataset such as SQuAD ( Rajpurkar et al , 2018 ) , this is a span prediction task where task - speciﬁc linear classiﬁers are used to predict start / end positions of the answer .
Standard metrics of F1 and Exact Match ( EM ) are reported .
NLI XNLI ( Conneau et al , 2018 ) is probably the most popular cross - lingual benchmark .
Notice that the original dataset only contains training data for English .
Consequently , we only evaluate this task on the zero - shot transfer setting while we consider both settings for the rest of other tasks .
3.3 Results and Analysis
In Table 2 and 3 , we report our results on NER , POS and QA together with XLM-100 , which is trained on 100 languages and contains 827 M parameters .
In particular , we observe that monolin4441  Model
ar
ru
sw
te
avg
Within - language Monolingual
Mono JointPair + ffn + attn + adpt + share adpt + meta adpt
XLM
JointPair + ffn + attn + adpt + share adpt + meta adpt
XLM
74.2 71.3 73.4 72.8 71.5 71.0 73.0
74.3
54.1 2.2 3.7 53.4 54.3 57.5
59.4
63.1 58.2 61.2 60.8 59.4 58.5 61.8
62.5
43.2 0.0 2.1 44.7 44.8 45.8
47.3
52.5 52.8 51.4 51.2 52.1 52.8 54.5
58.7
41.5 4.4 0.7 41.2 42.2 43.0
42.3
58.2 52.2 57.5 52.8 55.5 53.9 56.2
55.4
21.5 0.0 0.0 20.4 22.7 23.1
16.3
62.0 58.6 60.9 59.4 59.6 59.1 61.4
62.7
40.1 1.7 1.6 39.9 41.0 42.4
41.3
Zero - shot Cross
- lingual
Table 3 : TyDiQA - GoldP results ( F1 ) .
See Appendix C for full results .
gual models outperform bilingual models for all languages except Swahili on all three tasks .
In fact , monolingual models even perform better than XLM on four out of six languages including hi and te , despite that XLM is much larger in model sizes and trained with much more resources .
This shows that negative interference can occur on low - resource languages as well .
While the negative impact is expected to be more prominent on high - resource languages , we demonstrate that it may occur for languages with resources fewer than commonly believed .
The existence of negative interference conﬁrms that state - of - the - art multilingual models can not generalize equally well on all languages , and there is still a gap compared to monolingual models on certain languages .
We next turn to dissect negative interference by studying the four factors described in Section 3.1 .
Training Corpus Size By comparing the validation perplexity on Swahili and Telugu in Figure 2 , we ﬁnd that while both monolingual models outperform bilingual models in the ﬁrst few epochs , the Swahili model ’s perplexity starts to increase and is eventually surpassed by the bilingual model in later epochs .
This matches the intuition that monolingual models may overﬁt when training data size is small .
To verify this , we subsample French and Russian to 100k sentences to create a “ low - resource version ” of them ( denoted as frl / rul ) .
As shown in Table 5 , while the performance for both models drop compared to their “ high - resource ” counterparts , bilingual models indeed outperform monoModel
NER ( F1 ) te hi
POS ( F1 ) te hi
Within - language Monolingual
JointPair JointTri
88.3 87.8
76.2 76.4
95.2 95.3
88.7 88.7
Zero - shot Cross
- lingual
JointPair JointTri
61.4 63.5
45.2 47.6
58.9 59.5
72.8 74.4
Table 4 : Comparing trilingual models with bilingual models .
This shows the effect of adding a third similar language to bilingual models .
( a ) hi
( b ) sw
Figure 2 : Validation perplexity during pretraining .
lingual models for frl / rul , in contrast for fr / ru .
This suggests that multilingual models can stimulate positive transfer for low - resource languages when monolingual models overﬁt .
On the other hand , when we compare bilingual models on English , models trained using different sizes of fr / ru data obtain similar performance , indicating that the training size of the source language has little impact on negative interference on the target language ( English in this case ) .
While more training data usually implies larger vocabulary and more diverse linguistic phenomena , negative interference seems to arise from more fundamental conﬂicts contained in even small training corpus .
Language Similarity As illustrated by Table 5 , the in - language performance on English drops as the paired language becomes more distantly related ( French vs Russian ) .
This veriﬁes that transferring from more distant languages results in more severe negative interference .
It is therefore natural to ask if adding more similar languages can mitigate negative interference , especially for low - resource languages .
We then train two trilingual models , adding Marathi to English - Hindi , and Kannada to English - Telugu .
Compared to their bilingual counterparts ( Table 4 ) , trilingual models obtain similar within - language performance , which indicates that adding similar languages can not mitigate negative interference .
4442  Model
NER ( F1 ) ru frl
fr
rul
fr
POS ( F1 ) ru frl
rul
QA ( F1 / EM ) rul ru
Within - language Performance on fr / ru
Mono JointPair
88.0 86.5
81.7 83.2
87.8 84.2
82.4 82.7
76.2 75.8
68.5 71.4
96.7 93.2
88.7 89.5
63.1/49.2 58.2/43.1
47.2/29.5 49.5/30.4
Within - language Performance on en
JointPair
78.6
78.4
75.8
75.9
94.5
94.5
92.7
92.3
61.7/49.8
62.1/50.2
Table 5 : Evaluating effects of training corpus sizes on negative interference .
conﬂicts may imply that languages are ﬁghting for capacity .
Thus , we next study how languageuniversal these multilingual parameters are .
Figure 4a shows the cosine similarity of mask parameters π across different layers .
We observe that within - language similarity ( En - En ) is near perfect , which validates the pruning method ’s robustness .
The trend shows that model parameters are better shared in the bottom layers than the upper ones .
Besides , it also demonstrates that parameters in multi - head attention layers obtain higher similarities than those in feedforward layers , suggesting that attention mechanism might be more languageuniversal .
We additionally inspect π parameters with the highest absolute values and plot those values for Ar ( Figure 4b ) , together with their En counterparts .
A more negative value indicates that the parameter is more likely to be pruned for that language and vice versa .
Interestingly , while many parameters with positive values ( on the right ) are language - universal as both languages assign very positive values , parameters with negative values ( on the left ) are mostly language - speciﬁc for Ar as En assigns positive values .
We observe similar patterns for other languages as well .
These results demonstrate that language - speciﬁc parameters do exist in multilingual models .
Having language - speciﬁc capacity in shared parameters is sub - optimal .
It is less transferable and thus can hinder cross - lingual performance .
Moreover , it may also take over capacity budgets for other languages and degrade their within - language performance , i.e. , causing negative interference .
A natural next question is whether explicitly adding language - speciﬁc capacity into multilingual models can alleviate negative interference .
We thus train variants of bilingual models that contain language - speciﬁc components for each language .
Particularly , we consider adding language - speciﬁc feedforward layers , attention layers , and residual adapter layers ( Rebufﬁ et al , 2017 ; Houlsby et al , 2019 ) , denoted as ffn , attn and adpt respectively .
training .
Figure 3 : Gradients similarity throughout “ En - En ” refers to gradients of two English batches within the Ar - En model , while “ Ar - En ” and “ Fr - En ” refer to gradients of two batches , one from each language , within Ar - En and Fr - En models respectively .
However , they do improve zero - shot cross - lingual performance .
One possible explanation is that even similar languages can ﬁght for language - speciﬁc capacity but they may nevertheless beneﬁt the generalization of the shared knowledge .
Gradient Conﬂict In Figure 3 , we plot the gradient cosine similarity between Arabic - English and French - English in their corresponding bilingual models over the ﬁrst 25 epochs .
We also plot the similarity within English , measured using two independently sampled batches2 .
Speciﬁcally , gradients between two different languages are indeed less similar than those within the same language .
The gap is more evident in the early few epochs , where we observe negative gradient similarities for Ar - En and Fr - En while those for En - En are positive .
In addition , gradients in Ar - En are less similar than those in Fr - En , indicating that distant language pair can cause more severe gradient conﬂicts .
These results conﬁrm that gradient conﬂict exists in multilingual models and is correlated to per language performance , suggesting it may introduce optimization challenge that results in negative interference .
Parameter Sharing The existence of gradient
2Notice that we use gradient accumulation to sample an effectively larger batch of 4096 sentences to calculate the gradient similarity .
4443  ( a )
( b )
( c )
Figure 4 : Left : Parameter similarity across layers .
Middle : Normalized pruning variables of highest absolute values for Ar in Ar - En model .
10 parameter groups with most negative values are shown on the left and 10 with most positive values are shown on the right .
Right : Average MLM training loss after the warm - up stage .
For each type of component , we create two separate copies in each Transformer layer , one designated for each language , while the rest of the network remains unchanged .
As shown in Table 2 and 3 , adding language - speciﬁc capacity does mitigate negative interference and improve monolingual performance .
We also ﬁnd that language - speciﬁc feedforward layers obtain larger performance gains compared to attention layers , consistent with our prior analysis .
However , these gains come at a cost of cross - lingual transferability , such that their zeroshot performance drops tremendously .
Our results suggest a tension between addressing interference versus improving transferability .
In the next section , we investigate how to address negative interference in a manner that can improve performance on both within - language tasks and cross - lingual benchmarks .
4 Mitigating Negative Interference via
Meta Learning
4.1 Proposed Method
In the previous section , we demonstrated that while explicitly adding language - speciﬁc components can alleviate negative interference , it can also hinder cross - lingual transferability .
We notice that a critical shortcoming of language - speciﬁc capacity is that they are agnostic of the rest of other languages , since by design they are trained on the designated language only .
They are thus more likely to overﬁt and can induce optimization challenges for shared capacity as well .
Inspired by recent work in meta learning ( Flennerhag et al , 2019 ) that utilizes meta parameters to improve gradient geometry of the base network , we propose a novel meta - learning formulation of multilingual models that exploits language - speciﬁc parameters to improve generalization of shared parameters .
For a model with some predeﬁned languagespeciﬁc parameters φ = { φi}L i=1 , where φi is designated for the i - th language , and shared parameters θ , our solution is to treat φ as meta parameters and θ as base parameters .
Ideally , we want φ to store non - transferable language - speciﬁc knowledge to resolve conﬂicts and improve generalization of θ in all languages ( a.k.a . mitigate negative interference and improve cross - lingual transferability ) .
Therefore , we train φ based on the following principle : if θ follows the gradients on training data for a given φ , the resulting θ should obtain a good validation performance on all languages .
This implies a bilevel optimization problem ( Colson et al , 2007 ) formally written as :
min φ
1 L
L ( cid:88 )
i=1
val(θ∗ , φi ) Li
s.t . θ∗ = arg min
Li
train(θ , φi ) ,
1 L
L ( cid:88 )
i=1
θ
( 2 )
val and Li
where Li train denote the training and the validation MLM loss for the i - th language .
Since directly solving this problem can be prohibitive due to the expensive inner optimization , we approximate θ∗ by adapting the current θ(t ) using a single gradient step , similar to techniques used in prior meta - learning methods ( Finn et al , 2017 ) .
This results in a two - phase iterative training process shown in Algorithm 1 ( See Appendix B ) .
To be speciﬁc , at each training step t on the ith language during pretraining , we ﬁrst adapt a gradient step on θ to obtain a new θ(cid:48 ) and update φi
4444  Algorithm 1 Training XLM with Meta Language - speciﬁc Layers
1 : Input : Training data 2 : Output : The converged model { θ∗ , φ∗ } 3 : Initialize model parameters { θ(0 ) , φ(0 ) } 4 : while not converged do 5 :
Sample language i Update language - speciﬁc parameters as : i ← GradientUpdate(φ(t ) φ(t+1 )
, ∇
6 :
i
φ(t )
i
7 :
Update shared parameters as :
θ(t+1 ) ← GradientUpdate(θ(t ) , ∇θ(t)Ltrain(θ(t ) , φ(t+1 ) ) )
8 : end while
1 L
( cid:80)L
j=1 Lj
val(θ(t )
i − β∇θ(t)Li
train(θ(t ) , φ(t )
i ) , φ(t )
j ) )
based on the θ(cid:48 ) ’s validation MLM loss :
φ(t+1 )
i
= φ(t )
i − α∇
val(θ(cid:48 ) , φ(t )
Lj j )
1 L
L ( cid:88 )
j=1
φ(t )
i
( 3 )
θ(cid:48 ) = θ(t ) − β∇θ(t)Li
train(θ(t ) , φ(t ) i ) ,
where α and β are learning rates .
Notice that θ(cid:48 ) is a function of φ(t ) and thus this optimization requires i computing the gradient of gradient .
Particularly , by applying chain rule to the gradient of φ(t ) , we can i observe that it contains a higher - order term :
( cid:104 ) ∇2 φ
( t )
i
, θ(t ) Li
train(θ(t ) , φ(t ) i )
( cid:34 )
( cid:105 )
·
∇θ(cid:48 )
1 L
L ( cid:88 )
j=1
( cid:35 ) val(θ(cid:48 ) , φ(t )
Lj j )
( 4 ) This is important , since it shows that φi can obtain information from other languages through higherorder gradients .
In other words , language - speciﬁc parameters are not agnostic of other languages anymore without violating the language - speciﬁc requirement .
This is because , in Eq .
3 , while ∇θ(t ) is based on the i - th language only , the validation loss is computed for all languages .
Finally , in the second phase , we update θ based on the new φ(t+1 ):
θ(t+1 )
= θ(t ) − β∇θ(t)Ltrain(θ(t ) , φ(t+1 ) )
( 5 )
4.2 Evaluation
While our method is generic , we evaluate it applied on bilingual models with adapter networks .
Adapters have been effectively utilized in multilingual models ( Bapna et al , 2019 ) , and we choose them for practical consideration of limiting perlanguage capacity .
Unlike prior works that ﬁnetune adapters for adaptation , we train them jointly with shared parameters during pretraining .
We follow Houlsby et al ( 2019 ) and insert language - speciﬁc adapters after attention and feedforward layers .
We
leave a more thorough investigation of how to better pick language - speciﬁc structures for future work .
For downstream task evaluation , we ﬁnetune all layers .
Notice that computing the gradient of gradient in Eq .
3 doubles the memory requirement .
In practice , we utilize the ﬁnite difference approximation ( Appendix B ) .
By evaluating their performance on the zeroshot transfer settings ( Table 2 , 3 and 6 ) , we observe that our method , denoted as meta adpt , consistently improves the performance over JointPair baselines , while ordinary adapters ( adpt ) perform worse than JointPair .
This shows that , the proposed method can effectively utilize the added language - speciﬁc adapters to improve generalization of shared parameters across languages .
At the same time , our method also mitigates negative interference and outperforms JointPair on withinlanguage performance , closing the gap with monolingual models .
In particular , it performs better than ordinary adapters in both settings .
We hypothesize that this is because it alleviates language conﬂicts during training and thus converges more robustly .
For example , we plot training loss in the early stage in Figure 4c , which shows that ordinary adapters converge slower than JointPair due to overﬁtting of language - speciﬁc adapters while meta adapters converge much faster .
For ablation studies , we also report results for JointPair trained with adapters shared between two languages , denoted as share adpt .
Unlike language - speciﬁc adapters that can hinder transferability , shared adapters improve both within - language and cross - lingual performance with the extra capacity .
However , meta adapters still obtain better performance .
These results show that mitigating negative interference can improve multilingual representations .
4445  Model
JointPair + ffn + attn + adpt + share adpt + meta adpt
XLM
ar
67.1 42.5 48.5 67.8 67.9 68.5
68.2
fr
73.5 51.4 50.7 73.7 73.4 74.8
75.2
ru
69.2 40.7 41.2 69.5 70.0 70.2
72.3
hi
61.5 36.2 33.3 62.2 61.8 64.5
65.4
sw
62.3 34.8 35.1 59.7 62.2 61.5
58.1
avg
66.7 41.1 41.8 66.6 67.1 67.9
67.8
Table 6 : XNLI results ( Accuracy ) .
5 Related Work
Unsupervised multilingual language models such as mBERT ( Devlin et al , 2018 ) and XLM ( Lample and Conneau , 2019 ; Conneau et al , 2019 ) work surprisingly well on many NLP tasks without parallel training signals ( Pires et al , 2019 ; Wu and Dredze , 2019 ) .
A line of follow - up work ( Wu et al , 2019 ; Artetxe et al , 2019 ; Karthikeyan et al , 2020 ) study what contributes to the cross - lingual ability of these models .
They show that vocabulary overlap is not required for multilingual models , and suggest that abstractions shared across languages emerge automatically during pretraining .
Another line of research investigate how to further improve these shared knowledge , such as applying post - hoc alignment ( Wang et al , 2020b ; Cao et al , 2020 ) and utilizing better calibrated training signal ( Mulcaire et al , 2019 ; Huang et al , 2019 ) .
While prior work emphasize how to share to improve transferability , we study multilingual models from a different perspective of how to unshare to resolve language conﬂicts .
Our work is also related to transfer learning ( Pan and Yang , 2010 ) and multi - task learning ( Ruder , 2017 ) .
In particular , prior work have observed ( Rosenstein et al , 2005 ) and studied ( Wang et al , 2019 ) negative transfer , such that transferring knowledge from source tasks can degrade the performance in the target task .
Others show it is important to remedy negative transfer in multi - source settings ( Ge et al , 2014 ; Wang and Carbonell , 2018 ) .
In this work , we study negative transfer in multilingual models , where languages contain heavily unbalanced training data and exhibit complex intertask relatedness .
In addition , our work is related to methods that measure similarity between cross - lingual representations .
For example , existing methods utilize statistical metrics to examine cross - lingual embeddings such as singular vector canonical correlation analysis ( Raghu et al , 2017 ; Kudugunta et al , 2019 ) , eigenvector similarity ( Søgaard et al , 2018 ) ,
and centered kernel alignment ( Kornblith et al , 2019 ; Wu et al , 2019 ) .
While these methods focus on testing latent representations , we directly compare similarity of neural network structures through network pruning .
Finally , our work is related to meta learning , which sets a meta task to learn model initialization for fast adaptation ( Finn et al , 2017 ;
Gu et al , 2018 ; Flennerhag et al , 2019 ) , data selection ( Wang et al , 2020a ) , and hyperparameters ( Baydin et
al , 2018 )
.
In our case , the meta task is to mitigate negative interference .
6 Conclusion
We present the ﬁrst systematic study of negative interference in multilingual models and shed light on its causes .
We further propose a method and show it can improve cross - lingual transferability by mitigating negative interference .
While prior efforts focus on improving sharing and cross - lingual alignment , we provide new insights and a different perspective on unsharing and resolving language conﬂicts .
Acknowledgments
We want to thank Jaime Carbonell for his support on the early stage of this project .
We also would like to thank Zihang Dai , Graham Neubig , Orhan Firat , Yuan Cao , Jiateng Xie , Xinyi Wang , Ruochen Xu and Yiheng Zhou for insightful discussions .
Lastly , we thank anonymous reviewers for their valueable feedbacks .
